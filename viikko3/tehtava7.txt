7.
Lajittelu
a) Tulosta kymmenen aakkosjärjestyksessä ensimmäisen työntekijän tiedot sukunimen mukaan
lajiteltuna.
SELECT * FROM employees ORDER BY last_name LIMIT 10;

b) Sama kuten edellä, mutta sukunimen JA etunimen mukaan lajiteltuna.
SELECT * FROM employees ORDER BY last_name, first_name LIMIT 10;

c) Tulosta viiden viimeksi palkatun työntekijän tiedot.
SELECT * FROM employees ORDER BY hire_date DESC LIMIT 5;

d) Kenellä on suurin palkka ?
SELECT first_name,last_name,salary FROM employees JOIN salaries
ON employees.emp_no = salaries.emp_no
WHERE salary = (SELECT MAX(salary) FROM salaries);


e) Kenellä on pienin palkka ?
Ks. edellä MAX -> MIN

f) Tulosta työntekijät, jotka ansaitsevat yli 150000.
SELECT first_name, last_name, salary FROM employees e JOIN salaries s ON
e.emp_no=s.emp_no WHERE salary > 150000 AND to_date='9999-01-01' ORDER BY salary
DESC;

g) Kuinka monta työntekijää työskentelee myynnissä (Sales) ? Entä markkinoinnissa
(Marketing)?
select count(*) from employees join dept_emp on employees.emp_no=dept_emp.emp_no join
departments on dept_emp.dept_no=departments.dept_no where dept_name='Sales' AND
to_date='9999-01-01';


h) Tulosta kaikkien osastonjohtajien (Department Managers) etunimi, sukunimi ja osasto, jolla
työskentelee.
SELECT first_name AS Etunimi, last_name AS Sukunimi, dept_name AS Osasto FROM employees
e JOIN dept_manager dm ON e.emp_no=dm.emp_no JOIN departments d ON
dm.dept_no=d.dept_no;

i) Mikä on myynnissä työskentelevien keskipalkka ? Entä markkinoinnissa ?
SELECT AVG(salary) FROM salaries JOIN dept_emp ON salaries.emp_no=dept_emp.emp_no
JOIN departments ON dept_emp.dept_no=departments.dept_no WHERE dept_name='Sales'
AND dept_emp.to_date='9999-01-01';

